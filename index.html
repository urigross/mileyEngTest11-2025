<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jet 2 - ××©×—×§ ×”×›× ×” ×œ××‘×—×Ÿ</title>
    <style>
        :root {
            --primary: #4a90e2;
            --secondary: #f5a623;
            --success: #7ed321;
            --error: #d0021b;
            --bg: #f0f4f8;
            --card: #ffffff;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            margin: 0;
            padding: 20px;
            text-align: center;
            direction: rtl;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: var(--card);
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            padding: 30px;
            min-height: 500px;
            position: relative;
        }

        h1 { color: var(--primary); margin-bottom: 10px; }
        h2 { color: #555; font-size: 1.2rem; }

        .score-board {
            position: absolute;
            top: 20px;
            left: 20px;
            background: var(--secondary);
            color: white;
            padding: 10px 20px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 1.2rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .game-screen { display: none; }
        .game-screen.active { display: block; animation: fadeIn 0.5s; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.2rem;
            border-radius: 12px;
            cursor: pointer;
            margin: 10px;
            transition: transform 0.2s, background 0.2s;
            box-shadow: 0 4px 0 #357abd;
        }

        .btn:active { transform: translateY(4px); box-shadow: none; }
        .btn:hover { background: #357abd; }
        .btn-secondary { background: var(--secondary); box-shadow: 0 4px 0 #d48e15; }

        /* Game Elements */
        .emoji-display { font-size: 5rem; margin: 20px 0; display: block; }
        .word-options { display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; margin-top: 20px; }
        
        .listening-btn {
            font-size: 3rem;
            background: white;
            border: 2px solid #ddd;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: 0.3s;
        }
        .listening-btn:hover { background: #eef; border-color: var(--primary); transform: scale(1.1); }

        .input-box {
            font-size: 1.5rem;
            padding: 10px;
            border: 3px solid #ccc;
            border-radius: 10px;
            width: 60%;
            text-align: center;
            outline: none;
            margin-bottom: 20px;
        }
        .input-box:focus { border-color: var(--primary); }

        .feedback {
            font-size: 1.5rem;
            margin-top: 20px;
            font-weight: bold;
            min-height: 40px;
        }
        .feedback.correct { color: var(--success); }
        .feedback.wrong { color: var(--error); }

        /* Reading Section */
        .reading-text {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid var(--primary);
            text-align: left;
            font-size: 1.2rem;
            line-height: 1.6;
            margin-bottom: 20px;
            direction: ltr;
        }

        .question-box { text-align: right; direction: rtl; margin-top: 20px; }
        
        /* High Score Table */
        table { width: 100%; margin-top: 20px; border-collapse: collapse; }
        th, td { padding: 10px; border-bottom: 1px solid #ddd; }
        th { background: #f0f0f0; }

        .category-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 15px;
            background: #e1e1e1;
            color: #555;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }

        /* Confetti */
        .confetti { position: fixed; width: 10px; height: 10px; background-color: #f2d74e; animation: confetti 5s ease-in-out infinite; z-index: 999; }
    </style>
</head>
<body>

<div class="container">
    <div class="score-board">× ×™×§×•×“: <span id="currentScore">0</span></div>
    
    <div id="screen-menu" class="game-screen active">
        <h1>ğŸ“ ×”×›× ×” ×œ××‘×—×Ÿ ×‘×× ×’×œ×™×ª - ×›×™×ª×” ×“'</h1>
        <h2>At School - Unit 1</h2>
        <p>×‘×—×¨×™ ××©×—×§ ×›×“×™ ×œ×”×ª×—×™×œ:</p>
        
        <button class="btn" onclick="startGame('listening')">ğŸ‘‚ ×”×‘× ×ª ×”× ×©××¢</button>
        <button class="btn" onclick="startGame('vocab')">ğŸ“ ××•×¦×¨ ××™×œ×™× ×•×›×ª×™×‘×”</button>
        <button class="btn" onclick="startGame('sentences')">ğŸ§© ×”×©×œ××ª ××©×¤×˜×™×</button>
        <button class="btn" onclick="startGame('reading')">ğŸ“– ×”×‘× ×ª ×”× ×§×¨×</button>
        <br>
        <button class="btn btn-secondary" onclick="showLeaderboard()">ğŸ† ×œ×•×— ×ª×•×¦××•×ª</button>
    </div>

    <div id="screen-game" class="game-screen">
        <div id="category-title" class="category-badge"></div>
        <div id="game-content"></div>
        <div id="feedback" class="feedback"></div>
        <button class="btn" id="next-btn" style="display:none;" onclick="nextQuestion()">×”×‘×</button>
        <button class="btn btn-secondary" onclick="showMenu()">×™×¦×™××” ×œ×ª×¤×¨×™×˜</button>
    </div>

    <div id="screen-leaderboard" class="game-screen">
        <h1>ğŸ† ××œ×•×¤×™ ×”×× ×’×œ×™×ª</h1>
        <ul id="scores-list" style="list-style: none; padding: 0;"></ul>
        <button class="btn" onclick="showMenu()">×—×–×¨×”</button>
    </div>
</div>

<script>
    // --- Data ---
    const vocabulary = [
        { word: "school", icon: "ğŸ«", hebrew: "×‘×™×ª ×¡×¤×¨" },
        { word: "teacher", icon: "ğŸ‘©â€ğŸ«", hebrew: "××•×¨×”" },
        { word: "pupil", icon: "ğŸ‘§", hebrew: "×ª×œ××™×“/×”" },
        { word: "friend", icon: "ğŸ‘«", hebrew: "×—×‘×¨/×”" },
        { word: "family", icon: "ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦", hebrew: "××©×¤×—×”" },
        { word: "book", icon: "ğŸ“–", hebrew: "×¡×¤×¨" },
        { word: "notebook", icon: "ğŸ““", hebrew: "××—×‘×¨×ª" },
        { word: "pencil", icon: "âœï¸", hebrew: "×¢×™×¤×¨×•×Ÿ" },
        { word: "eraser", icon: "ğŸ§¼", hebrew: "××—×§" },
        { word: "computer", icon: "ğŸ’»", hebrew: "××—×©×‘" },
        { word: "lunch", icon: "ğŸ¥ª", hebrew: "××¨×•×—×ª ×¦×”×¨×™×™×" },
        { word: "bird", icon: "ğŸ¦", hebrew: "×¦×™×¤×•×¨" },
        { word: "house", icon: "ğŸ ", hebrew: "×‘×™×ª" },
        { word: "math", icon: "â—", hebrew: "×—×©×‘×•×Ÿ" },
        { word: "art", icon: "ğŸ¨", hebrew: "××•×× ×•×ª" },
        { word: "music", icon: "ğŸµ", hebrew: "××•×–×™×§×”" },
        { word: "sports", icon: "âš½", hebrew: "×¡×¤×•×¨×˜" },
        { word: "happy", icon: "ğŸ˜Š", hebrew: "×©××—" },
        { word: "write", icon: "âœï¸", hebrew: "×œ×›×ª×•×‘" },
        { word: "homework", icon: "ğŸ ğŸ“š", hebrew: "×©×™×¢×•×¨×™ ×‘×™×ª" }
    ];

    const sentences = [
        { text: "The _____ is on the table.", options: ["book", "fly"], answer: "book" },
        { text: "I like my _____. She is nice.", options: ["teacher", "day"], answer: "teacher" },
        { text: "We learn _____ at school.", options: ["English", "lunch"], answer: "English" },
        { text: "I have a sandwich for _____.", options: ["lunch", "pencil"], answer: "lunch" },
        { text: "This is my _____, Dan.", options: ["brother", "board"], answer: "brother" },
        { text: "Please _____ your name.", options: ["write", "happy"], answer: "write" },
        { text: "I live in a big _____.", options: ["house", "chair"], answer: "house" },
        { text: "The _____ is singing.", options: ["bird", "book"], answer: "bird" }
    ];

    const readingText = `
        Hi! My name is Gal. I am 9 years old.
        I am a pupil in grade 4.
        I learn at a big school in the town.
        My teacher is Rina. She is very nice.
        I like Math, English and Sports.
        I have a new computer at home.
    `;

    const readingQuestions = [
        { q: "What is the girl's name?", options: ["Rina", "Gal", "Tal"], answer: "Gal" },
        { q: "What grade is she in?", options: ["Grade 3", "Grade 5", "Grade 4"], answer: "Grade 4" },
        { q: "What is the teacher's name?", options: ["Rina", "Gal", "Dana"], answer: "Rina" },
        { q: "What does she have at home?", options: ["A bird", "A new computer", "A dog"], answer: "A new computer" }
    ];

    // --- State ---
    let score = 0;
    let currentMode = '';
    let currentQuestionIndex = 0;
    let currentData = [];

    // --- Logic ---

    function speak(text) {
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'en-US';
        utterance.rate = 0.9;
        window.speechSynthesis.speak(utterance);
    }

    function switchScreen(id) {
        document.querySelectorAll('.game-screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }

    function updateScoreDisplay() {
        document.getElementById('currentScore').innerText = score;
    }

    function showMenu() {
        switchScreen('screen-menu');
    }

    function startGame(mode) {
        currentMode = mode;
        score = 0;
        currentQuestionIndex = 0;
        updateScoreDisplay();
        switchScreen('screen-game');
        
        let title = "";
        if (mode === 'listening') title = "×”×§×©×™×‘×™ ×•×œ×—×¦×™ ×¢×œ ×”×ª××•× ×” ×”× ×›×•× ×”";
        if (mode === 'vocab') title = "×›×ª×‘×™ ××ª ×”××™×œ×” ×‘×× ×’×œ×™×ª";
        if (mode === 'sentences') title = "×”×©×œ×™××™ ××ª ×”××©×¤×˜";
        if (mode === 'reading') title = "×§×¨××™ ××ª ×”×˜×§×¡×˜ ×•×¢× ×™ ×¢×œ ×”×©××œ×•×ª";
        
        document.getElementById('category-title').innerText = title;
        generateLevelData();
        renderQuestion();
    }

    function generateLevelData() {
        // Randomize questions slightly
        if (currentMode === 'listening' || currentMode === 'vocab') {
            currentData = [...vocabulary].sort(() => 0.5 - Math.random()).slice(0, 10);
        } else if (currentMode === 'sentences') {
            currentData = [...sentences].sort(() => 0.5 - Math.random()).slice(0, 8);
        } else if (currentMode === 'reading') {
            currentData = [...readingQuestions]; // Fixed order for reading
        }
    }

    function renderQuestion() {
        const container = document.getElementById('game-content');
        const feedback = document.getElementById('feedback');
        const nextBtn = document.getElementById('next-btn');
        
        container.innerHTML = '';
        feedback.innerText = '';
        feedback.className = 'feedback';
        nextBtn.style.display = 'none';

        if (currentQuestionIndex >= currentData.length) {
            endGame();
            return;
        }

        const item = currentData[currentQuestionIndex];

        // --- Listening Logic ---
        if (currentMode === 'listening') {
            // Pick 2 wrong answers + 1 correct
            let options = [item];
            while(options.length < 3) {
                let r = vocabulary[Math.floor(Math.random() * vocabulary.length)];
                if (!options.includes(r)) options.push(r);
            }
            options.sort(() => 0.5 - Math.random());

            const btnSpeak = document.createElement('button');
            btnSpeak.className = 'btn btn-secondary';
            btnSpeak.innerText = 'ğŸ”Š ×”×©××™×¢×™ ××ª ×”××™×œ×”';
            btnSpeak.onclick = () => speak(item.word);
            
            // Auto speak on load
            setTimeout(() => speak(item.word), 500);

            const optionsDiv = document.createElement('div');
            optionsDiv.className = 'word-options';
            
            options.forEach(opt => {
                const b = document.createElement('div');
                b.className = 'listening-btn';
                b.innerText = opt.icon;
                b.onclick = () => checkAnswer(opt.word, item.word);
                optionsDiv.appendChild(b);
            });

            container.appendChild(btnSpeak);
            container.appendChild(optionsDiv);
        }

        // --- Vocabulary Logic ---
        if (currentMode === 'vocab') {
            const icon = document.createElement('div');
            icon.className = 'emoji-display';
            icon.innerText = item.icon;
            
            const hint = document.createElement('div');
            hint.innerText = item.hebrew;
            hint.style.fontSize = "1.2rem";
            hint.style.marginBottom = "10px";

            const input = document.createElement('input');
            input.type = 'text';
            input.className = 'input-box';
            input.placeholder = 'Type here...';
            input.onkeypress = (e) => { if(e.key === 'Enter') checkAnswer(input.value, item.word); };

            const checkBtn = document.createElement('button');
            checkBtn.className = 'btn';
            checkBtn.innerText = '×‘×“×™×§×”';
            checkBtn.onclick = () => checkAnswer(input.value, item.word);

            container.appendChild(icon);
            container.appendChild(hint);
            container.appendChild(input);
            container.appendChild(checkBtn);
            input.focus();
        }

        // --- Sentences Logic ---
        if (currentMode === 'sentences') {
            const sentenceDiv = document.createElement('div');
            sentenceDiv.style.fontSize = "1.5rem";
            sentenceDiv.style.marginBottom = "20px";
            sentenceDiv.style.direction = "ltr";
            sentenceDiv.innerText = item.text;

            const optionsDiv = document.createElement('div');
            optionsDiv.className = 'word-options';

            item.options.forEach(opt => {
                const b = document.createElement('button');
                b.className = 'btn';
                b.innerText = opt;
                b.onclick = () => checkAnswer(opt, item.answer);
                optionsDiv.appendChild(b);
            });

            container.appendChild(sentenceDiv);
            container.appendChild(optionsDiv);
        }

        // --- Reading Logic ---
        if (currentMode === 'reading') {
            // Show text only on first question or always? Let's show always for help
            const textDiv = document.createElement('div');
            textDiv.className = 'reading-text';
            textDiv.innerText = readingText;

            const qDiv = document.createElement('div');
            qDiv.className = 'question-box';
            qDiv.style.direction = "ltr";
            qDiv.style.textAlign = "center";
            qDiv.innerHTML = `<h3>${item.q}</h3>`;

            const optionsDiv = document.createElement('div');
            optionsDiv.className = 'word-options';

            item.options.forEach(opt => {
                const b = document.createElement('button');
                b.className = 'btn';
                b.innerText = opt;
                b.onclick = () => checkAnswer(opt, item.answer);
                optionsDiv.appendChild(b);
            });

            container.appendChild(textDiv);
            container.appendChild(qDiv);
            container.appendChild(optionsDiv);
        }
    }

    function checkAnswer(userAnswer, correctAnswer) {
        // Prevent multiple clicks
        if (document.getElementById('next-btn').style.display === 'inline-block') return;

        const feedback = document.getElementById('feedback');
        userAnswer = userAnswer.trim().toLowerCase();
        correctAnswer = correctAnswer.trim().toLowerCase();

        if (userAnswer === correctAnswer) {
            feedback.innerText = "Excellent! ×›×œ ×”×›×‘×•×“! ğŸ‰";
            feedback.className = "feedback correct";
            score += 10;
            speak("Good job!");
            triggerConfetti();
        } else {
            feedback.innerText = `×œ× × ×•×¨×, ×”×ª×©×•×‘×” ×”× ×›×•× ×” ×”×™×: ${correctAnswer}`;
            feedback.className = "feedback wrong";
            speak("Try again next time");
        }

        updateScoreDisplay();
        document.getElementById('next-btn').style.display = 'inline-block';
    }

    function nextQuestion() {
        currentQuestionIndex++;
        renderQuestion();
    }

    function endGame() {
        const container = document.getElementById('game-content');
        container.innerHTML = `
            <h2>×¡×™×™××ª ××ª ×”××©×—×§!</h2>
            <div class="emoji-display">ğŸ†</div>
            <h3>×”× ×™×§×•×“ ×©×œ×š: ${score}</h3>
            <p>×©××¨×™ ××ª ×©××š ×‘×œ×•×— ×”×ª×•×¦××•×ª:</p>
            <input type="text" id="playerName" class="input-box" placeholder="×©××š..." style="width:200px">
            <br>
            <button class="btn" onclick="saveToLeaderboard()">×©××•×¨</button>
        `;
        document.getElementById('next-btn').style.display = 'none';
        document.getElementById('feedback').innerText = '';
    }

    // --- Leaderboard Logic ---
    function saveToLeaderboard() {
        const name = document.getElementById('playerName').value || "Anonymous";
        const date = new Date().toLocaleDateString('he-IL');
        
        let scores = JSON.parse(localStorage.getItem('englishGameScores')) || [];
        scores.push({ name, score, date, mode: currentMode });
        scores.sort((a, b) => b.score - a.score);
        scores = scores.slice(0, 10); // Keep top 10
        
        localStorage.setItem('englishGameScores', JSON.stringify(scores));
        showLeaderboard();
    }

    function showLeaderboard() {
        switchScreen('screen-leaderboard');
        const list = document.getElementById('scores-list');
        list.innerHTML = '';
        const scores = JSON.parse(localStorage.getItem('englishGameScores')) || [];

        if (scores.length === 0) {
            list.innerHTML = '<li>×¢×“×™×™×Ÿ ××™×Ÿ ×ª×•×¦××•×ª... ×”×™×™ ×”×¨××©×•× ×” ×œ×©×—×§!</li>';
            return;
        }

        scores.forEach((s, i) => {
            const li = document.createElement('li');
            li.style.padding = "10px";
            li.style.borderBottom = "1px solid #ddd";
            li.style.fontSize = "1.1rem";
            // Translate mode to Hebrew for display
            let modeHeb = s.mode === 'listening' ? '×©××™×¢×”' : (s.mode === 'vocab' ? '×›×ª×™×‘×”' : '×“×§×“×•×§');
            li.innerHTML = `<strong>#${i+1} ${s.name}</strong> - ${s.score} × ×§' (${modeHeb}) <span style="font-size:0.8rem; color:#888">${s.date}</span>`;
            list.appendChild(li);
        });
    }

    // --- Effects ---
    function triggerConfetti() {
        for(let i=0; i<30; i++) {
            const c = document.createElement('div');
            c.className = 'confetti';
            c.style.left = Math.random() * 100 + 'vw';
            c.style.animationDuration = (Math.random() * 3 + 2) + 's';
            c.style.backgroundColor = '#' + Math.floor(Math.random()*16777215).toString(16);
            document.body.appendChild(c);
            setTimeout(() => c.remove(), 5000);
        }
    }

</script>

</body>
</html>
