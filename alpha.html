<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>××©×—×§×™× ×œ×™××•×“×™×™× ×œ×™×œ×“×™×</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; text-align: center; background-color: #f0f8ff; margin: 0; padding: 20px; }
        h1 { color: #333; }
        
        /* ×ª×¤×¨×™×˜ ×¨××©×™ ×•×›×¤×ª×•×¨×™× */
        .menu-btn { padding: 15px 30px; font-size: 1.2rem; margin: 10px; cursor: pointer; border: none; border-radius: 10px; background-color: #4CAF50; color: white; transition: 0.3s; }
        .menu-btn:hover { background-color: #45a049; transform: scale(1.05); }
        .settings-btn { background-color: #607d8b; }

        /* ××–×•×¨×™ ×”××©×—×§ ×•×”×”×’×“×¨×•×ª */
        .game-container, #settings-screen { display: none; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); max-width: 600px; margin: 20px auto; }
        .active { display: block; }

        /* ×¢×™×¦×•×‘ ×××ª ××• ×©×§×¨ */
        #tf-image-container img { max-width: 150px; height: auto; margin: 20px; border: 3px solid #ddd; border-radius: 10px; }
        .tf-btn { width: 100px; height: 50px; margin: 10px; font-size: 1.2rem; cursor: pointer; }
        .btn-true { background-color: #4CAF50; color: white; }
        .btn-false { background-color: #f44336; color: white; }

        /* ×¢×™×¦×•×‘ ×¡× ×™×™×§ */
        #game-board { width: 400px; height: 400px; background-color: #333; margin: 20px auto; position: relative; border: 5px solid #555; }
        .snake-part { width: 20px; height: 20px; background-color: lime; position: absolute; }
        .food-item { width: 20px; height: 20px; background-color: red; position: absolute; border-radius: 50%; }
        .word-label { position: absolute; color: white; font-size: 12px; white-space: nowrap; top: -15px; left: -10px; }

        /* ×¢×™×¦×•×‘ ×”×’×“×¨×•×ª (Settings) */
        .settings-group { margin-bottom: 20px; text-align: right; padding: 10px; border-bottom: 1px solid #eee; }
        .switch { position: relative; display: inline-block; width: 60px; height: 34px; vertical-align: middle; margin-right: 10px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 26px; width: 26px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: #2196F3; }
        input:checked + .slider:before { transform: translateX(26px); }
        
        #reset-progress-btn { background-color: #f44336; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; opacity: 1; }
        #reset-progress-btn:disabled { background-color: #ccc; cursor: not-allowed; opacity: 0.6; }
        .explanation { font-size: 0.9rem; color: #666; margin-top: 5px; }
    </style>
</head>
<body>

    <div id="main-menu" class="active">
        <h1>××©×—×§×™× ×œ×™××•×“×™×™×</h1>
        <button class="menu-btn" onclick="showGame('snake')">×¡× ×™×™×§ ××™×œ×™× ğŸ</button>
        <button class="menu-btn" onclick="showGame('truefalse')">×××ª ××• ×©×§×¨ âœ…âŒ</button>
        <br>
        <button class="menu-btn settings-btn" onclick="showSettings()">×”×’×“×¨×•×ª âš™ï¸</button>
    </div>

    <div id="settings-screen">
        <h2>×”×’×“×¨×•×ª ××¢×¨×›×ª</h2>
        
        <div class="settings-group">
            <label class="switch">
                <input type="checkbox" id="progressive-toggle" onchange="toggleProgressiveMode()">
                <span class="slider"></span>
            </label>
            <strong>×œ××™×“×” ×¤×¨×•×’×¨×¡×™×‘×™×ª</strong>
            <p class="explanation">×›××©×¨ ××•×¤×¢×œ: ××™×œ×™× ×©×”×™×œ×“ ×¢× ×” ×¢×œ×™×”×Ÿ × ×›×•×Ÿ ×œ× ×™×•×¤×™×¢×• ×©×•×‘ ×‘××©×—×§×™× ×”×‘××™×.</p>
        </div>

        <div class="settings-group">
            <button id="reset-progress-btn" onclick="resetProgress()" disabled>××™×¤×•×¡ ×”×ª×§×“××•×ª ×œ×”×ª×—×œ×” â†º</button>
            <p class="explanation">××•×—×§ ××ª ×”××™×œ×™× ×©× ×©××¨×• ×‘×–×™×›×¨×•×Ÿ ×•××—×–×™×¨ ××ª ×›×•×œ×Ÿ ×œ××©×—×§ (×¤×¢×™×œ ×¨×§ ×‘××¦×‘ ×¤×¨×•×’×¨×¡×™×‘×™).</p>
        </div>

        <button class="menu-btn settings-btn" onclick="showMainMenu()">×—×–×•×¨ ×œ×ª×¤×¨×™×˜</button>
    </div>

    <div id="snake-game" class="game-container">
        <h2>×¡× ×™×™×§ ××™×œ×™×</h2>
        <p>××›×•×œ ××ª ×”××™×œ×”: <span id="target-word-snake" style="font-weight:bold; color:blue;"></span></p>
        <div id="game-board"></div>
        <button class="menu-btn" onclick="endGame()">×™×¦×™××”</button>
    </div>

    <div id="tf-game" class="game-container">
        <h2>×××ª ××• ×©×§×¨?</h2>
        <h3 id="tf-word">××™×œ×”</h3>
        <div id="tf-image-container"></div>
        <br>
        <button class="tf-btn btn-true" onclick="checkTF(true)">×××ª</button>
        <button class="tf-btn btn-false" onclick="checkTF(false)">×©×§×¨</button>
        <br>
        <button class="menu-btn" onclick="endGame()">×™×¦×™××”</button>
    </div>

    <audio id="chew-sound" src="https://www.soundjay.com/human/sounds/eating-chip-1.mp3"></audio>

<script>
    // --- ×××’×¨ ×”× ×ª×•× ×™× ---
    // ×›××Ÿ ×ª×•×›×œ ×œ×”×•×¡×™×£ ×ª××•× ×•×ª ×××™×ª×™×•×ª ×‘××§×•× ×”-placeholder
    const allWords = [
        { id: 1, word: "×‘×™×ª", image: "https://via.placeholder.com/150?text=House" },
        { id: 2, word: "×œ×‘", image: "https://via.placeholder.com/150?text=Heart" },
        { id: 3, word: "×›×œ×‘", image: "https://via.placeholder.com/150?text=Dog" },
        { id: 4, word: "×—×ª×•×œ", image: "https://via.placeholder.com/150?text=Cat" },
        { id: 5, word: "×©××©", image: "https://via.placeholder.com/150?text=Sun" }
    ];

    // --- ××©×ª× ×™ ××¢×¨×›×ª ---
    let activeWords = []; // ×”××™×œ×™× ×œ××©×—×§ ×”× ×•×›×—×™
    let knownWords = JSON.parse(localStorage.getItem('knownWords')) || []; // ×˜×¢×™× ×” ××–×™×›×¨×•×Ÿ
    let isProgressive = localStorage.getItem('isProgressive') === 'true'; // ×˜×¢×™× ×ª ×”×’×“×¨×”

    // ××ª×—×•×œ ×›×¤×ª×•×¨×™× ×‘×”×ª×—×œ×”
    updateSettingsUI();

    // --- ×¤×•× ×§×¦×™×•×ª ×¢×–×¨ (Logic) ---

    // 1. ×¤×•× ×§×¦×™×™×ª ×¢×¨×‘×•×‘ (Fisher-Yates Shuffle) - ××‘×˜×™×— ×¡×“×¨ ×¨× ×“×•××œ×™
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

    // 2. ×”×›× ×ª ×”××™×œ×™× ×œ××©×—×§ (×¡×™× ×•×Ÿ ×•×¢×¨×‘×•×‘)
    function prepareGameWords() {
        let pool = allWords;

        // ×× ××¦×‘ ×¤×¨×•×’×¨×¡×™×‘×™ ×¤×¢×™×œ, ××¡× × ×™× ××™×œ×™× ×™×“×•×¢×•×ª
        if (isProgressive) {
            pool = allWords.filter(w => !knownWords.includes(w.id));
            if (pool.length === 0) {
                alert("×›×œ ×”×›×‘×•×“! ×¡×™×™××ª ××ª ×›×œ ×”××™×œ×™× ×‘×××’×¨! ×××¤×¡ ×”×ª×§×“××•×ª ×œ×¦×•×¨×š ×ª×¨×’×•×œ.");
                resetProgress();
                pool = allWords;
            }
        }

        // ×©×›×¤×•×œ ×”××¢×¨×š ×›×“×™ ×œ× ×œ×”×¨×•×¡ ××ª ×”××§×•×¨×™, ×•××– ×¢×¨×‘×•×‘
        activeWords = shuffleArray([...pool]);
    }

    // 3. ×¡×™××•×Ÿ ××™×œ×” ×›"×™×“×•×¢×”"
    function markWordAsKnown(wordId) {
        if (isProgressive) {
            if (!knownWords.includes(wordId)) {
                knownWords.push(wordId);
                localStorage.setItem('knownWords', JSON.stringify(knownWords));
            }
        }
    }

    // --- × ×™×”×•×œ ××¡×›×™× ×•×”×’×“×¨×•×ª ---

    function showMainMenu() {
        hideAll();
        document.getElementById('main-menu').classList.add('active');
    }

    function showSettings() {
        hideAll();
        document.getElementById('settings-screen').classList.add('active');
        updateSettingsUI();
    }

    function hideAll() {
        document.querySelectorAll('.active').forEach(el => el.classList.remove('active'));
        stopSnake(); // ×¢×¦×™×¨×ª ××©×—×§×™× ×‘×¨×§×¢ ×× ×¨×¦×™×
    }

    function endGame() {
        showMainMenu();
    }

    // ×œ×•×’×™×§×ª ×›×¤×ª×•×¨ ×”×”×’×“×¨×•×ª
    function toggleProgressiveMode() {
        const toggle = document.getElementById('progressive-toggle');
        isProgressive = toggle.checked;
        localStorage.setItem('isProgressive', isProgressive);
        updateSettingsUI();
    }

    function updateSettingsUI() {
        document.getElementById('progressive-toggle').checked = isProgressive;
        document.getElementById('reset-progress-btn').disabled = !isProgressive;
    }

    function resetProgress() {
        if (confirm("×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××¤×¡ ××ª ×”×”×ª×§×“××•×ª? ×›×œ ×”××™×œ×™× ×™×•×¤×™×¢×• ××—×“×©.")) {
            knownWords = [];
            localStorage.setItem('knownWords', JSON.stringify(knownWords));
            alert("×”×”×ª×§×“××•×ª ××•×¤×¡×” ×‘×”×¦×œ×—×”!");
        }
    }


    // --- ××©×—×§: ×××ª ××• ×©×§×¨ ---
    let currentTFWord;
    let isCorrectTF;

    function showGame(type) {
        hideAll();
        prepareGameWords(); // ×›××Ÿ ××ª×‘×¦×¢ ×”×¢×¨×‘×•×‘ ×•×”×¡×™× ×•×Ÿ!

        if (type === 'truefalse') {
            document.getElementById('tf-game').classList.add('active');
            nextTFRound();
        } else if (type === 'snake') {
            document.getElementById('snake-game').classList.add('active');
            initSnakeGame();
        }
    }

    function nextTFRound() {
        if (activeWords.length === 0) {
            alert("×¡×™×™××ª ××ª ×”××©×—×§!");
            endGame();
            return;
        }

        // ×œ×•×§×—×™× ××ª ×”××™×œ×” ×”×¨××©×•× ×” ××”×¨×©×™××” ×”××¢×•×¨×‘×‘×ª
        currentTFWord = activeWords[0]; // ×œ× ××•×¦×™××™× ××•×ª×” ×¢×“×™×™×Ÿ (pop) ×›×“×™ ×©×× ×˜×¢×” × ×—×–×™×¨
        
        // ×”×’×¨×œ×”: ×”×× ×œ×”×¦×™×’ ×ª×©×•×‘×” × ×›×•× ×” ××• ×©×’×•×™×”?
        isCorrectTF = Math.random() < 0.5;
        
        let displayImage;
        if (isCorrectTF) {
            displayImage = currentTFWord.image;
        } else {
            // ×‘×•×—×¨×™× ×ª××•× ×” ××§×¨××™×ª ××—×¨×ª
            const otherWords = allWords.filter(w => w.id !== currentTFWord.id);
            const randomWrong = otherWords[Math.floor(Math.random() * otherWords.length)];
            displayImage = randomWrong.image;
        }

        document.getElementById('tf-word').innerText = currentTFWord.word;
        
        // --- ×ª×™×§×•×Ÿ ×”×‘××’: × ×™×§×•×™ ×ª××•× ×•×ª ×§×•×“××•×ª ---
        const imgContainer = document.getElementById('tf-image-container');
        imgContainer.innerHTML = ''; // ×× ×§×” ×”×›×œ
        
        const img = document.createElement('img');
        img.src = displayImage;
        imgContainer.appendChild(img);
    }

    function checkTF(answer) {
        if (answer === isCorrectTF) {
            // ×ª×©×•×‘×” × ×›×•× ×”
            alert("× ×›×•×Ÿ ×××•×“!");
            markWordAsKnown(currentTFWord.id);
            // ×”×¡×¨×ª ×”××™×œ×” ××”×¨×©×™××” ×”× ×•×›×—×™×ª ×›×“×™ ×©×œ× ×ª×—×–×•×¨ ×‘××©×—×§ ×”×–×”
            activeWords.shift();
        } else {
            // ×ª×©×•×‘×” ×©×’×•×™×”
            alert("×œ× × ×›×•×Ÿ, × ×¡×” ×©×•×‘!");
            // ×‘××§×¨×” ×©×œ ×˜×¢×•×ª, ×”××¢×¨×›×ª ×”×¤×¨×•×’×¨×¡×™×‘×™×ª ×œ× ××¡×× ×ª ××ª ×”××™×œ×” ×›×™×“×•×¢×”
            // ×•×× ×—× ×• ××©××™×¨×™× ××•×ª×” ×‘×¨×©×™××” (××• ××¢×¨×‘×‘×™× ××•×ª×” ×œ×¡×•×£)
            activeWords.push(activeWords.shift()); // ××¢×‘×™×¨ ×œ×¡×•×£
        }
        nextTFRound();
    }


    // --- ××©×—×§: ×¡× ×™×™×§ ---
    let snake, direction, food, gameInterval;
    const boardSize = 400;
    const box = 20;

    function initSnakeGame() {
        if (activeWords.length === 0) {
            alert("××™×Ÿ ××™×œ×™× ×–××™× ×•×ª ×œ××©×—×§!");
            endGame();
            return;
        }
        
        snake = [{x: 200, y: 200}];
        direction = "RIGHT";
        spawnFood();
        
        document.addEventListener('keydown', changeDirection);
        if (gameInterval) clearInterval(gameInterval);
        gameInterval = setInterval(drawSnake, 150);
    }

    function stopSnake() {
        if (gameInterval) clearInterval(gameInterval);
        document.removeEventListener('keydown', changeDirection);
    }

    function spawnFood() {
        // ×‘×•×—×¨×™× ××™×œ×” ××”×¨×©×™××”
        const targetWordObj = activeWords[Math.floor(Math.random() * activeWords.length)];
        document.getElementById('target-word-snake').innerText = targetWordObj.word;
        
        food = {
            x: Math.floor(Math.random() * (boardSize/box)) * box,
            y: Math.floor(Math.random() * (boardSize/box)) * box,
            wordObj: targetWordObj
        };
    }

    function changeDirection(event) {
        const key = event.keyCode;
        if (key == 37 && direction != "RIGHT") direction = "LEFT";
        else if (key == 38 && direction != "DOWN") direction = "UP";
        else if (key == 39 && direction != "LEFT") direction = "RIGHT";
        else if (key == 40 && direction != "UP") direction = "DOWN";
    }

    function drawSnake() {
        const board = document.getElementById('game-board');
        board.innerHTML = ''; // × ×™×§×•×™ ×œ×•×—

        // ×¦×™×•×¨ ××•×›×œ
        const foodDiv = document.createElement('div');
        foodDiv.className = 'food-item';
        foodDiv.style.left = food.x + 'px';
        foodDiv.style.top = food.y + 'px';
        board.appendChild(foodDiv);

        // ×ª× ×•×¢×ª ×¨××©
        let snakeX = snake[0].x;
        let snakeY = snake[0].y;

        if (direction == "LEFT") snakeX -= box;
        if (direction == "UP") snakeY -= box;
        if (direction == "RIGHT") snakeX += box;
        if (direction == "DOWN") snakeY += box;

        // ×‘×“×™×§×ª ××›×™×œ×”
        if (snakeX == food.x && snakeY == food.y) {
            // --- ×”×¤×¢×œ×ª ×¡××•× ×“ ---
            const audio = document.getElementById("chew-sound");
            audio.currentTime = 0; // ××™×¤×•×¡ ×œ×”×ª×—×œ×” ×× ×× ×’×Ÿ
            audio.play().catch(e => console.log("Sound error (autoplay policy):", e));
            
            // ×¡×™××•×Ÿ ×”×¦×œ×—×”
            markWordAsKnown(food.wordObj.id);
            
            // ×”×¡×¨×ª ×”××™×œ×” ×©× ××›×œ×” ××”×¨×©×™××” ×”× ×•×›×—×™×ª ×‘××©×—×§ ×”×–×”
            activeWords = activeWords.filter(w => w.id !== food.wordObj.id);
            if(activeWords.length === 0) {
                 alert("× ×™×¦×—×ª! ××›×œ×ª ××ª ×›×œ ×”××™×œ×™×.");
                 endGame();
                 return;
            }

            spawnFood();
        } else {
            snake.pop(); // ××—×™×§×ª ×–× ×‘
        }

        // ×’×‘×•×œ×•×ª ×•×”×ª× ×’×©×•×ª ×¢×¦××™×ª
        if (snakeX < 0 || snakeX >= boardSize || snakeY < 0 || snakeY >= boardSize || collision(snakeX, snakeY, snake)) {
            alert("× ×¤×¡×œ×ª! × ×¡×” ×©×•×‘.");
            initSnakeGame();
            return;
        }

        const newHead = {x: snakeX, y: snakeY};
        snake.unshift(newHead);

        // ×¦×™×•×¨ × ×—×©
        for (let i = 0; i < snake.length; i++) {
            const part = document.createElement('div');
            part.className = 'snake-part';
            part.style.left = snake[i].x + 'px';
            part.style.top = snake[i].y + 'px';
            board.appendChild(part);
        }
    }

    function collision(x, y, array) {
        for (let i = 0; i < array.length; i++) {
            if (x == array[i].x && y == array[i].y) return true;
        }
        return false;
    }
</script>

</body>
</html>
